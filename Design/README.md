# 设计原则

S O L（Liskov） I D 五大设计原则

- 单一职责原则
- 开放封闭原则
- 李氏置换原则
- 接口独立原则
- 依赖导致原则

-----

## 介绍

### 单一职责原则

一个程序只做好一件事，如果功能过于复杂就拆分开，每个部分保持独立。

### 开放封闭原则

对修改封闭，对扩展开放，**这是软件设计的终极目标**。即要设计一种机制，当需求发生变化时，根据这种机制扩展代码，而不是修改原有的代码。

### 李氏置换原则

子类能覆盖父类，父类能出现的地方子类就能出现。JS 中子类继承父类的场景较少，又不是强类型语言，因此体现较少。

### 接口独立原则

保持接口的单一独立，避免出现“胖接口”。类似于单一职责原则，只不过前者说的比较统一，后者是单独对接口的规定。JS 中没有接口，因此体现较少。

### 依赖倒置原则

面向接口编程，依赖于抽象而不依赖于具体。写代码时用到具体类时，不与具体类交互，而与具体类的上层接口交互。

-----

## 举例说明

后三个原则是基于高级面向对象语言语法的（如 java），找不到太合适的例子，就先以常见的 Promise 来解释一下前两个原则。

```js
// 加载图片
function loadImg(src) {
  var promise = new Promise(function (resolve, reject) {
    var img = document.createElement('img')
    img.onload = function () {
      resolve(img)
    }
    img.onerror = function () {
      reject('图片加载失败')
    }
    img.src = src
  })
  return promise
}

var src = 'http://img4.imgtn.bdimg.com/it/u=2144501804,1367734064&fm=26&gp=0.jpg'
var result = loadImg(src)

result.then(function (img) {
  console.log('img.width', img.width)
  return img
}).then(function (img) {
  console.log('img.height', img.height)
}).catch(function (ex) {
  // 统一捕获异常
  console.log(ex)
})
```

- 单一职责原则：每个`then`中的逻辑只做好一件事，如果要做多个就用多个`then`
- 开放封闭原则：如果这个需求要修改，那去扩展`then`即可，现有的逻辑不用修改，即对扩展开放、对修改封闭

这里引申两点：

- 其实 S 和 O 是相符现成的，相互依赖
- 开放封闭原则的好处不止于此，从整个软件开发流程看，减少现有逻辑的更改，也会减少测试的成本

# 从设计到模式

“设计”和“模式”应该分开看。“设计”即设计原则、设计思想，“模式”即一些固话了的符合设计原则的既定方式、成型的可套用的模板。现有“设计”后有“模式”，因此应该“从设计到模式”，不能将“设计模式”作为一个词来称呼。

这并不是故意咬文爵字。

# 简介 23 种设计模式

以下是所有 23 种设计模式。一些是前端常用且能找到经典使用场景的，一些是不常用或者找不到代表性的使用场景的。根据使用的不同，讲解时也会区分优先级，重点的模式详细讲解。

- 创建型模式
  - **工厂模式**（工厂方法模式，抽象工厂模式，建造者模式）
  - **单例模式**
  - 原型模式
- 结构型模式
  - **适配器模式**
  - **装饰器模式**
  - **代理模式**
  - **外观模式**
  - 桥接模式
  - 组合模式
  - 享元模式
- 行为型模式
  - 策略模式
  - 模板方法模式
  - **观察者模式**
  - **迭代器模式**
  - 职责连模式
  - 命令模式
  - 备忘录模式
  - **状态模式**
  - 访问者模式
  - 中介者模式
  - 解释器模式